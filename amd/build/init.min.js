define("block_a11y_check/init",["exports","jquery","core/notification","core/templates","core/chartjs","core/modal_factory","./util"],(function(_exports,_jquery,_notification,_templates,_chartjs,_modal_factory,_util){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_jquery=_interopRequireDefault(_jquery),_templates=_interopRequireDefault(_templates),_chartjs=_interopRequireDefault(_chartjs),_modal_factory=_interopRequireDefault(_modal_factory);_exports.init=data=>{async function createModal(){const $table=function(){const $table=(0,_jquery.default)("<table/>").addClass("table table-bordered table-hover table-responsive table-sm").append((0,_jquery.default)("<thead/>").append((0,_jquery.default)("<tr/>").append((0,_jquery.default)("<th/>").attr("scope","col").text("Filename")).append((0,_jquery.default)("<th/>").attr("scope","col").text("Bookmarks")).append((0,_jquery.default)("<th/>").attr("scope","col").text("Lang")).append((0,_jquery.default)("<th/>").attr("scope","col").text("Text")).append((0,_jquery.default)("<th/>").attr("scope","col").text("Title")).append((0,_jquery.default)("<th/>").attr("scope","col").text("Tagged")).append((0,_jquery.default)("<th/>").attr("scope","col").text("Pages")))),$tableBody=(0,_jquery.default)("<tbody/>"),$tableRows=[].concat(data.pdfs.pass,data.pdfs.warn,data.pdfs.fail).map((pdf=>(0,_jquery.default)("<tr/>").append((0,_jquery.default)("<td/>").addClass("text-truncate").append((0,_jquery.default)("<a/>").attr("href",pdf.url).text(pdf.filename))).append((0,_jquery.default)("<td/>").append("1"===pdf.hasbookmarks?(0,_jquery.default)((0,_util.renderSuccessIcon)()):(0,_jquery.default)((0,_util.renderFailIcon)()))).append((0,_jquery.default)("<td/>").append("1"===pdf.haslanguage?(0,_jquery.default)((0,_util.renderSuccessIcon)()):(0,_jquery.default)((0,_util.renderFailIcon)()))).append((0,_jquery.default)("<td/>").append("1"===pdf.hastext?(0,_jquery.default)((0,_util.renderSuccessIcon)()):(0,_jquery.default)((0,_util.renderFailIcon)()))).append((0,_jquery.default)("<td/>").append("1"===pdf.hastitle?(0,_jquery.default)((0,_util.renderSuccessIcon)()):(0,_jquery.default)((0,_util.renderFailIcon)()))).append((0,_jquery.default)("<td/>").append("1"===pdf.istagged?(0,_jquery.default)((0,_util.renderSuccessIcon)()):(0,_jquery.default)((0,_util.renderFailIcon)()))).append((0,_jquery.default)("<td/>").append(pdf.pagecount>=1?(0,_jquery.default)("<span/>").text(pdf.pagecount):(0,_jquery.default)((0,_util.renderFailIcon)())))));return $tableBody.append($tableRows),$table.append($tableBody),$table}(),$modalBody=(0,_jquery.default)("<div/>").append(function($table){return(0,_jquery.default)("<button/>").addClass("btn btn-secondary mb-2").text("Download to CSV").click((()=>(0,_util.downloadAsCSV)($table.get())))}($table)).append($table),modal=await _modal_factory.default.create({title:"A11y Check Details",body:$modalBody,footer:"<p>Last updated mm dd at ##:##:##</p>",large:!0});return modal.getRoot()[0].childNodes[1].style.maxWidth="95vw",modal}_templates.default.renderForPromise("block_a11y_check/summary",{name:"A11y Check"}).then((_ref=>{let{html:html,js:js}=_ref;_templates.default.appendNodeContents("#block-a11y-check-root",html,js),createModal().then((modal=>{(0,_jquery.default)("#block-a11y-check-more-details-root").append(function(modal){return(0,_jquery.default)("<button/>").addClass("btn btn-secondary").text("Details").click((()=>modal.show()))}(modal)),data.pdfs.pass.length>0||data.pdfs.warn.length>0||data.pdfs.fail.length>0?function(){const canvas=(0,_jquery.default)("<canvas/>").attr({id:"#block-a11y-check-pie-chart-canvas","aria-label":"A11y check pie chart describing the a11y status of the course PDFs."}),ctx=canvas[0].getContext("2d");(0,_jquery.default)("#block-a11y-check-pie-chart-root").append((0,_jquery.default)("<h6/>").addClass("mb-2").text("PDF Accessibility")).append(canvas);const chartData={labels:["Pass (".concat(data.pdfs.pass.length,")"),"Warn (".concat(data.pdfs.warn.length,")"),"Fail (".concat(data.pdfs.fail.length,")")],datasets:[{label:"A11y Check",data:[data.pdfs.pass.length,data.pdfs.warn.length,data.pdfs.fail.length],backgroundColor:["#5cb85c","#f0ad4e","#d9534f"]}]};new _chartjs.default(ctx,{type:"pie",data:chartData})}():(0,_jquery.default)("#block-a11y-check-root").append((0,_jquery.default)("<p/>").text("No data to show"))})).catch((error=>(0,_notification.exception)(error)))})).catch((error=>(0,_notification.exception)(error)))}}));

//# sourceMappingURL=init.min.js.map